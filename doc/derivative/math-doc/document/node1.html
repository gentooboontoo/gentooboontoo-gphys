<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with jLaTeX2HTML 2K.1beta (1.48) JA patch-1.4
patched version by:  Kenshi Muto, Debian Project.
LaTeX2HTML 2K.1beta (1.48),
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>不等間隔格子の二次精度差分</TITLE>
<META NAME="description" CONTENT="不等間隔格子の二次精度差分">
<META NAME="keywords" CONTENT="document">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-2022-jp">
<META NAME="Generator" CONTENT="jLaTeX2HTML v2K.1beta JA patch-1.4">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="document.css">

<LINK REL="next" HREF="node2.html">
<LINK REL="previous" HREF="document.html">
<LINK REL="up" HREF="document.html">
<LINK REL="next" HREF="node2.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html13"
  HREF="node2.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html11"
  HREF="document.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5"
  HREF="document.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> :</B> <A NAME="tex2html14"
  HREF="node2.html">この文書について...</A>
<B> :</B> <A NAME="tex2html12"
  HREF="document.html">NumRu::Derivative</A>
<B> :</B> <A NAME="tex2html6"
  HREF="document.html">NumRu::Derivative</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION000100000000000000000">
不等間隔格子の二次精度差分</A>
</H1>
本ドキュメントでは, NumRu::Derivative で定義される threepoints_O2nd_deriv で用いる
不等間隔格子の二次精度差分についてまとめる. この差分は極端に不等間隔ではないデータに
対して二次精度の差分を与えるものである.

今, 関数<IMG
 WIDTH="41" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$ f(x)$">を, 数列 <!-- MATH
 $x_n (x_0, x_1, ..., x_{i}, ..., x_{n})$
 -->
<IMG
 WIDTH="184" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$ x_n (x_0, x_1, ..., x_{i}, ..., x_{n})$"> 上に離散化する.
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="19" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img3.png"
 ALT="$\displaystyle f_i$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="67" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img4.png"
 ALT="$\displaystyle \equiv f(x_i)$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.1)</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="12" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$\displaystyle t$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="112" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img6.png"
 ALT="$\displaystyle \equiv (x_{i+1} - x_{i})$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.2)</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="14" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img7.png"
 ALT="$\displaystyle s$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="112" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$\displaystyle \equiv (x_{i} - x_{i-1})$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.3)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
ここで, <IMG
 WIDTH="14" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img9.png"
 ALT="$ s$">と<IMG
 WIDTH="12" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img10.png"
 ALT="$ t$">はほぼ同じオーダーの値である場合を想定して議論を進める.

ここで, <IMG
 WIDTH="41" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$ f(x)$">を各格子点近傍にてテイラー展開する.
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="129" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.png"
 ALT="$\displaystyle f(x_{i+1}) - f(x_{i})$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="235" HEIGHT="64" ALIGN="MIDDLE" BORDER="0"
 SRC="img12.png"
 ALT="$\displaystyle = tf'(x_i) + \frac{t^2}{2}f''(x_i) + O(t^3)$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.4)</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="129" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.png"
 ALT="$\displaystyle f(x_{i-1}) - f(x_{i})$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="256" HEIGHT="64" ALIGN="MIDDLE" BORDER="0"
 SRC="img14.png"
 ALT="$\displaystyle = -sf'(x_i) + \frac{s^2}{2}f''(x_i) + O(s^3)$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.5)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
ここで, <!-- MATH
 $f'(x_i), f''(x_i)$
 -->
<IMG
 WIDTH="109" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img15.png"
 ALT="$ f'(x_i), f''(x_i)$">はそれぞれ<IMG
 WIDTH="21" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img16.png"
 ALT="$ x_i$">における<IMG
 WIDTH="16" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img17.png"
 ALT="$ f$">の<IMG
 WIDTH="15" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img18.png"
 ALT="$ x$">に関する一階および二階の微分項, <IMG
 WIDTH="48" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ O(t^3)$">は<IMG
 WIDTH="19" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img20.png"
 ALT="$ t^3$">のオーダーの値を表す. 両式から<IMG
 WIDTH="24" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img21.png"
 ALT="$ f''$">の項を消去するために, <IMG
 WIDTH="36" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img22.png"
 ALT="$ s^2\times$">(1.4) - <IMG
 WIDTH="34" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img23.png"
 ALT="$ t^2\times$">(1.5) を計算すると,
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="229" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="img24.png"
 ALT="$\displaystyle s^2f_{i+1} + (t^2 -s^2)f_i - t^2f_{i-1}$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="314" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="img25.png"
 ALT="$\displaystyle = (s^2 + st^2)f'(x_i) + s^2O(t^3) + t^2O(s^3)$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.6)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
となる. 上式を変形して
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="233" HEIGHT="64" ALIGN="MIDDLE" BORDER="0"
 SRC="img26.png"
 ALT="$\displaystyle \frac{s^2f_{i+1} + (t^2 -s^2)f_i - t^2f_{i-1}}{st(s + t)}$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="241" HEIGHT="64" ALIGN="MIDDLE" BORDER="0"
 SRC="img27.png"
 ALT="$\displaystyle = f'(x_i) + \frac{O(s^2t^3) + O(t^2s^3)}{st(s + t)}$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.7)</TD></TR>
<TR VALIGN="MIDDLE">
<TD>&nbsp;</TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="73" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.png"
 ALT="$\displaystyle = O(t^2).$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.8)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
これより, 2次精度差分の公式は
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="51" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img29.png"
 ALT="$\displaystyle f'(x_i)$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="252" HEIGHT="64" ALIGN="MIDDLE" BORDER="0"
 SRC="img30.png"
 ALT="$\displaystyle = \frac{s^2f_{i+1} + (t^2 -s^2)f_i - t^2f_{i-1}}{st(s + t)}$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1.9)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
と書くことができる.

<BR><HR>
<ADDRESS>
Tsukahara Daisuke
平成17年3月3日
</ADDRESS>
</BODY>
</HTML>
